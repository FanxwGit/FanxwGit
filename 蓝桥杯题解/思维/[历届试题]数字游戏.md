# 思维

##  [历届试题]数字游戏

> 栋和同学们一共n个人围坐在一圈。栋栋首先说出数字1。接下来，坐在栋栋左手边的同学要说下一个数字2。再下面的一个同学要从上一个同学说的数字往下数两个数说出来，也就是说4。下一个同学要往下数三个数，说7。依次类推。 
>
> 输入的第一行包含三个整数 n,k,T，其中 n 和 k 的意义如上面所述，T 表示到目前为止栋栋一共说出的数字个数。1 <  n,k,T <  1,000,000；
>
> 输出一行，包含一个整数，表示栋栋说出所有数的和。 

## 解析

有$n$个人，会经过$T$轮，那么总共有$nT$个学生进行报数，每个人将上一个人喊的数字增加$cnt$，并且$cnt$每次都+1，那么第i个人喊的数为
$$
(\sum_{cnt}^n{cnt}+1)\%k
$$
因此我们对每一轮可以通过等差数列的性质，快速求出下一轮的栋栋要喊的数字，然后进行累加即可

```c++
#include<bits/stdc++.h>
typedef long long ll;
using namespace std;
int main()
{
	ll a = 0;//首
	ll n, k, t;
	cin >> n >> k >> t;
	ll sum = 1;
	ll ans = 0;
	for (int i = 0; i < t; i++) {
		ll a = i * n;
		ans += sum;
		sum =sum + ((a + 1) + ((i + 1)*n))*n / 2;//要注意开long long
		sum %= k;
	}
	cout << ans;
}
```

## 进阶优化

* 经验之谈：加数取模的操作很可能会存在循环节，因此我们打表找规律....下图循环节大小为5

  ![image-20210403152730120](C:\Users\37802\AppData\Roaming\Typora\typora-user-images\image-20210403152730120.png)

  经过多次打表发现...发现栋栋喊的数字和k与n有关，并且k和n相同的时候为1，因此我得出一结论，关于循环节的大小$d$.

  * $k$为偶数$d=2k$
  * $k$为奇数$d=k$

  得出循环节之后，算出这次运算需要执行$time$个循环节，即$time=T/d$，会额外的剩下几轮，即$left=T%d$,再利用等差数列的性质算出算出来即可，本文不多赘述。

  ```
  #include<bits/stdc++.h>
  typedef long long ll;
  using namespace std;
  int main()
  {
  	ll a = 0;//首项
  	ll n, k, t,d;
  	ll sum = 1;
  	ll ans = 0;
  	cin >> n >> k >> t;
  	if (k & 1) {
  		d = k;
  	}
  	else {
  		d = 2 * k;
  	}
  	ll left = t % d;
  	ll leftSum = 0;//用来统计
  	ll time = t / d;
  	for (ll i = 0; i < d; i++) {//d轮
  		a = i * n;
  		ans += sum;
  		if (i < left)leftSum += sum;
  		sum = sum + ((a + 1) + ((i + 1)*n))*n / 2;
  		sum %= k;
  	}
  	cout << ans * time + leftSum;
  }
  
  
  
  ```

  

